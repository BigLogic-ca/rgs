
> jest
> cd .. && jest --config tests/jest/jest.config.ts

PASS CLIENT tests/jest/tests/migration.test.ts
  Migration Tests
    âˆš should migrate data on version change (15 ms)
    âˆš should not migrate if versions match (3 ms)
    âˆš should handle multiple migrations (3 ms)

PASS CLIENT tests/jest/tests/security.test.ts
  Security Tests
    Input Validation
      âˆš should validate correct keys (21 ms)
      âˆš should reject invalid keys (3 ms)
      âˆš should sanitize values (6 ms)
    Access Control (RBAC)
      âˆš should allow by default (6 ms)
      âˆš should restrict with rules (2 ms)
      âˆš should fail closed when rule exists but not matched (1 ms)
    GDPR Compliance
      âˆš should record consent (7 ms)
      âˆš should check consent status (21 ms)
      âˆš should get all consents (4 ms)
      âˆš should revoke consent (2 ms)
      âˆš should export user data (3 ms)
      âˆš should delete user data (5 ms)
    Audit Logging
      âˆš should log operations to custom logger (6 ms)

  console.info
    [BruteForce] 1000 concurrent sets: 1.61ms

      at Object.<anonymous> (tests/jest/tests/brute_force_v.test.ts:22:17)

  console.info
    [BruteForce] 100-level deep object (Set+Get): 8.08ms

      at Object.<anonymous> (tests/jest/tests/brute_force_v.test.ts:42:17)

PASS CLIENT tests/jest/tests/integration.test.ts
  Ecosystem Integration
    âˆš should create a store with plugins (23 ms)
    âˆš should use immer plugin to update nested state (7 ms)
    âˆš should use undo-redo plugin to manage history (4 ms)
    âˆš should handle both plugins together (3 ms)
    â—‹ skipped should work seamlessly with the useStore hook

  console.error
    [gState] RBAC Denied for "logs"

    [0m [90m 287 |[39m         [36mconst[39m hasLimits [33m=[39m (_maxObjectSize [33m>[39m [35m0[39m [33m||[39m _maxTotalSize [33m>[39m [35m0[39m) [33m&&[39m process[33m.[39menv[33m.[39m[33mNODE_ENV[39m [33m!==[39m [32m'production'[39m
     [90m 288 |[39m         [36mconst[39m finalSize [33m=[39m hasLimits [33m?[39m _calculateSize(frozen) [33m:[39m [35m0[39m
    [31m[1m>[22m[39m[90m 289 |[39m
     [90m     |[39m [31m[1m^[22m[39m
     [90m 290 |[39m         [36mif[39m (_maxObjectSize [33m>[39m [35m0[39m [33m&&[39m finalSize [33m>[39m _maxObjectSize) {
     [90m 291 |[39m           [36mconst[39m error [33m=[39m [36mnew[39m [33mError[39m([32m`Object size (${finalSize} bytes) exceeds maxObjectSize (${_maxObjectSize} bytes)`[39m)
     [90m 292 |[39m           [36mif[39m (_onError) _onError(error[33m,[39m { operation[33m:[39m [32m'set'[39m[33m,[39m key })[0m

      at magic.set (core/store.ts:289:29)
      at Object.<anonymous> (tests/jest/tests/examples_v.test.ts:47:39)

  console.error
    [gState] RBAC Denied for "logs"

    [0m [90m 287 |[39m         [36mconst[39m hasLimits [33m=[39m (_maxObjectSize [33m>[39m [35m0[39m [33m||[39m _maxTotalSize [33m>[39m [35m0[39m) [33m&&[39m process[33m.[39menv[33m.[39m[33mNODE_ENV[39m [33m!==[39m [32m'production'[39m
     [90m 288 |[39m         [36mconst[39m finalSize [33m=[39m hasLimits [33m?[39m _calculateSize(frozen) [33m:[39m [35m0[39m
    [31m[1m>[22m[39m[90m 289 |[39m
     [90m     |[39m [31m[1m^[22m[39m
     [90m 290 |[39m         [36mif[39m (_maxObjectSize [33m>[39m [35m0[39m [33m&&[39m finalSize [33m>[39m _maxObjectSize) {
     [90m 291 |[39m           [36mconst[39m error [33m=[39m [36mnew[39m [33mError[39m([32m`Object size (${finalSize} bytes) exceeds maxObjectSize (${_maxObjectSize} bytes)`[39m)
     [90m 292 |[39m           [36mif[39m (_onError) _onError(error[33m,[39m { operation[33m:[39m [32m'set'[39m[33m,[39m key })[0m

      at magic.set (core/store.ts:289:29)
      at addLog (examples/rbac-dashboard/DashboardStore.ts:40:42)
      at Object.<anonymous> (tests/jest/tests/examples_v.test.ts:48:53)

  console.warn
    [Security] Access Denied for user manager-101: Insufficient permissions for 'logs'

    [0m [90m 42 |[39m   [36mif[39m ([33m![39msuccess) {
     [90m 43 |[39m     console[33m.[39mwarn([32m`[Security] Access Denied for user ${useDashboard.userId}: Insufficient permissions for 'logs'`[39m)
    [31m[1m>[22m[39m[90m 44 |[39m   }
     [90m    |[39m    [31m[1m^[22m[39m
     [90m 45 |[39m   [36mreturn[39m success
     [90m 46 |[39m }
     [90m 47 |[39m[0m

      at addLog (examples/rbac-dashboard/DashboardStore.ts:44:17)
      at Object.<anonymous> (tests/jest/tests/examples_v.test.ts:48:53)

  console.info
    [Stress] Rapid Fire (1000 updates): 9.65ms

      at Object.<anonymous> (tests/jest/tests/stress_v.test.ts:16:17)

PASS CLIENT tests/jest/tests/features.test.ts
  New Features
    encoded option (replaces secure)
      âˆš should encode data with encoded: true (96 ms)
      âˆš should support legacy secure option (backward compatibility) (59 ms)
      âˆš should not encode when encoded: false (67 ms)
    onError callback
      âˆš should call onError on plugin crash (5 ms)
      âˆš should call onError on hydration failure (1 ms)
      âˆš should fallback to console.error when onError not provided (5 ms)
    maxObjectSize warning
      âˆš should warn when object exceeds maxObjectSize (3 ms)
      âˆš should not warn when object is within limit (1 ms)
      âˆš should disable warnings when maxObjectSize is 0 (1 ms)
      âˆš should use default 5MB limit when not specified (1 ms)
    Integration: All features together
      âˆš should work with encoded + onError + maxObjectSize (71 ms)

PASS CLIENT tests/jest/tests/examples_v.test.ts
  RGS Examples Validation
    âˆš Basic Counter validation (15 ms)
    âˆš Global Theme validation (2 ms)
    âˆš Persistent Cart validation (6 ms)
    âˆš Secure Auth validation (2 ms)
    âˆš Security Vault validation (Async Init) (17 ms)
    âˆš RBAC Dashboard validation (122 ms)

  console.log
    --- Scenario 1: Basic Store ---

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:7:17)

  console.info
    [Stress] Big Payload (2000 keys): 45.60ms

      at Object.<anonymous> (tests/jest/tests/stress_v.test.ts:28:17)

  console.info
    [Stress] Computed Chain verified: base(10) -> l5(15)

      at Object.<anonymous> (tests/jest/tests/stress_v.test.ts:45:17)

PASS CLIENT tests/jest/tests/stress_v.test.ts
  RGS Stress Test Validation
    âˆš Rapid Fire: handle 1000 synchronous sets (123 ms)
    âˆš Big Payload: handle 2000 keys object (67 ms)
    âˆš Computed Chain: recursive dependency updates (8 ms)

  console.log
    âœ… Basic Store OK

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:16:17)

  console.log
    --- Scenario 2: Computed Values ---

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:20:17)

  console.log
    âœ… Computed Values OK

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:34:17)

  console.log
    --- Scenario 3: Custom Plugin ---

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:38:17)

  console.log
    âœ… Custom Plugin OK

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:59:17)

  console.log
    --- Scenario 4: Transactions ---

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:63:17)

  console.log
    âœ… Transactions OK

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:77:17)

  console.log
    --- Scenario 5: Type-Safe Selectors ---

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:81:17)

  console.log
    âœ… Type-Safe Selectors OK

      at Object.<anonymous> (tests/jest/tests/simulation.test.ts:101:17)

PASS CLIENT tests/jest/tests/simulation.test.ts
  100M$ DOLLAR SIMULATION ðŸš€
    âˆš Scenario 1: Basic Store - Increment (135 ms)
    âˆš Scenario 2: Computed Values (5 ms)
    âˆš Scenario 3: Custom Plugin (5 ms)
    âˆš Scenario 4: Transactions (7 ms)
    âˆš Scenario 5: Type-Safe Selectors (15 ms)

PASS CLIENT tests/jest/tests/multi-store-security.test.ts
  Multi-Store Security Isolation
    âˆš should isolate access rules between different stores (5 ms)
    âˆš should isolate consents between different stores (4 ms)
    âˆš should handle plugin methods isolation (2 ms)

PASS CLIENT tests/jest/tests/core.test.ts
  Argis (RGS)
    âˆš Async Store: Auto-handling life-cycle (5 ms)
    âˆš Plugins: Kernel Transaction Hook (2 ms)
    âˆš Immutability: Deep recursive freezing (8 ms)

  console.log
    Set 10k keys: 410.92ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:18:17)

  console.info
    [BruteForce] 50,000 updates via 500 transactions: 269.76ms

      at Object.<anonymous> (tests/jest/tests/brute_force_v.test.ts:57:17)

PASS CLIENT tests/jest/tests/init.test.ts
  âˆš state config exist (2 ms)

PASS CLIENT tests/jest/tests/basic.test.ts
  Basic State Tests
    âˆš State should exist globally (1 ms)
    âˆš Should set and get a simple value (2 ms)
    âˆš Should handle number values (1 ms)
  Object State Tests
    âˆš Should handle object values (4 ms)
    âˆš Should handle nested objects (1 ms)
  Array State Tests
    âˆš Should handle array values (3 ms)
    âˆš Should allow array mutations (1 ms)

  console.info
    [BruteForce] 10,000 keys (~40MB raw state): 470.37ms

      at Object.<anonymous> (tests/jest/tests/brute_force_v.test.ts:71:17)

  console.info
    [BruteForce] 1000 RBAC evaluations x 500 ops: 6.95ms

      at Object.<anonymous> (tests/jest/tests/brute_force_v.test.ts:94:17)

PASS CLIENT tests/jest/tests/brute_force_v.test.ts
  RGS Brutal Force Test Suite (Core Only)
    âˆš Concurrency: 1000 "parallel" async sets (190 ms)
    âˆš Deep Nesting: 100-level deep object (Recursion Test) (16 ms)
    âˆš Transaction Overload: 500 transactions / 100 ops each (417 ms)
    âˆš Memory Pressure: 10,000 large-ish keys (Total ~20MB) (491 ms)
    âˆš RBAC Chaos: 1000 dynamic rules evaluation (10 ms)

  console.log
    Get 10k keys: 699.49ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:26:17)

  console.log
    1,000 updates: 14.27ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:38:17)

  console.log
    5000 rapid cycles: 298.94ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:52:17)

  console.log
    Large object (100KB) - Set: 74.14ms, Get: 0.01ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:67:17)

  console.log
    50 namespaces x 100 keys: 35.04ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:83:17)

  console.log
    1,000 updates with 100 listeners: 9.14ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:97:17)

PASS CLIENT tests/jest/tests/stress.test.ts
  Stress Tests - Enterprise Performance
    âˆš should handle 10,000 keys efficiently (1196 ms)
    âˆš should handle 1,000 updates to same key (18 ms)
    âˆš should handle rapid set/get cycles (300 ms)
    âˆš should handle large object values (181 ms)
    âˆš should handle multiple namespaces efficiently (37 ms)
    âˆš should maintain performance with listeners (11 ms)

Test Suites: 13 passed, 13 total
Tests:       1 skipped, 70 passed, 71 total
Snapshots:   0 total
Time:        7.209 s
Ran all test suites.
