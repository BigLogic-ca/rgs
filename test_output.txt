npm verbose cli C:\Program Files\nodejs\node.exe C:\Users\dario\AppData\Roaming\npm\node_modules\npm\bin\npm-cli.js
npm info using npm@11.7.0
npm info using node@v24.5.0
npm verbose title npm test
npm verbose argv "test"
npm verbose logfile logs-max:10 dir:C:\Users\dario\AppData\Local\npm-cache\_logs\2026-02-16T01_15_42_582Z-
npm verbose logfile C:\Users\dario\AppData\Local\npm-cache\_logs\2026-02-16T01_15_42_582Z-debug-0.log

> react-globo-state@2.7.0 test
> node --experimental-vm-modules node_modules/jest/bin/jest.js --config ./tests/jest/jest.config.ts

PASS CLIENT tests/jest/tests/security.test.ts
  Security Tests
    Input Validation
      âˆš should validate correct keys (35 ms)
      âˆš should reject invalid keys (6 ms)
      âˆš should sanitize values (5 ms)
    Access Control (RBAC)
      âˆš should allow by default (2 ms)
      âˆš should restrict with rules (2 ms)
      âˆš should fail closed when rule exists but not matched (1 ms)
    GDPR Compliance
      âˆš should record consent (5 ms)
      âˆš should check consent status (3 ms)
      âˆš should get all consents (2 ms)
      âˆš should revoke consent (2 ms)
      âˆš should export user data (2 ms)
      âˆš should delete user data (2 ms)
    Audit Logging
      âˆš should log operations to custom logger (8 ms)

PASS CLIENT tests/jest/tests/migration.test.ts
  Migration Tests
    âˆš should migrate data on version change (67 ms)
    âˆš should not migrate if versions match (2 ms)
    âˆš should handle multiple migrations (2 ms)

PASS CLIENT tests/jest/tests/features.test.ts
  New Features
    encoded option (replaces secure)
      âˆš should encode data with encoded: true (137 ms)
      âˆš should support legacy secure option (backward compatibility) (77 ms)
      âˆš should not encode when encoded: false (68 ms)
    onError callback
      âˆš should call onError on plugin crash (6 ms)
      âˆš should call onError on hydration failure (2 ms)
      âˆš should fallback to console.error when onError not provided (3 ms)
    maxObjectSize warning
      âˆš should warn when object exceeds maxObjectSize (3 ms)
      âˆš should not warn when object is within limit (3 ms)
      âˆš should disable warnings when maxObjectSize is 0 (2 ms)
      âˆš should use default 5MB limit when not specified (2 ms)
    Integration: All features together
      âˆš should work with encoded + onError + maxObjectSize (93 ms)

PASS CLIENT tests/jest/tests/basic.test.ts
  Basic State Tests
    âˆš State should exist globally (13 ms)
    âˆš Should set and get a simple value (20 ms)
    âˆš Should handle number values (1 ms)
  Object State Tests
    âˆš Should handle object values (1 ms)
    âˆš Should handle nested objects (11 ms)
  Array State Tests
    âˆš Should handle array values (4 ms)
    âˆš Should allow array mutations (11 ms)

PASS CLIENT tests/jest/tests/multi-store-security.test.ts
  Multi-Store Security Isolation
    âˆš should isolate access rules between different stores (26 ms)
    âˆš should isolate consents between different stores (8 ms)
    âˆš should handle plugin methods isolation (6 ms)

  console.log
    Set 10k keys: 969.88ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:18:17)

PASS CLIENT tests/jest/tests/init.test.ts
  âˆš state config exist (11 ms)

PASS CLIENT tests/jest/tests/integration.test.ts
  Ecosystem Integration
    âˆš should create a store with plugins (44 ms)
    âˆš should use immer plugin to update nested state (8 ms)
    âˆš should use undo-redo plugin to manage history (5 ms)
    âˆš should work seamlessly with the useStore hook (41 ms)
    âˆš should handle both plugins together (2 ms)

PASS CLIENT tests/jest/tests/core.test.ts
  React Globo State
    âˆš Async Store: Auto-handling life-cycle (26 ms)
    âˆš Plugins: Kernel Transaction Hook (5 ms)
    âˆš Immutability: Deep recursive freezing (9 ms)

  console.log
    Get 10k keys: 761.72ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:26:17)

  console.log
    1,000 updates: 12.74ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:38:17)

  console.log
    5000 rapid cycles: 401.04ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:52:17)

  console.log
    Large object (100KB) - Set: 240.55ms, Get: 0.01ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:67:17)

  console.log
    50 namespaces x 100 keys: 66.27ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:83:17)

  console.log
    1,000 updates with 100 listeners: 11.49ms

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:97:17)

FAIL CLIENT tests/jest/tests/stress.test.ts
  Stress Tests - Enterprise Performance
    âˆš should handle 10,000 keys efficiently (1848 ms)
    âˆš should handle 1,000 updates to same key (17 ms)
    âˆš should handle rapid set/get cycles (403 ms)
    Ã— should handle large object values (409 ms)
    âˆš should handle multiple namespaces efficiently (69 ms)
    âˆš should maintain performance with listeners (14 ms)

  â— Stress Tests - Enterprise Performance â€º should handle large object values

    expect(received).toBeLessThan(expected)

    Expected: < 150
    Received:   240.54579999999987

    [0m [90m 67 |[39m     [36mconst[39m store [33m=[39m createStore({ namespace[33m:[39m [32m'stress-large'[39m[33m,[39m silent[33m:[39m [36mtrue[39m })
     [90m 68 |[39m
    [31m[1m>[22m[39m[90m 69 |[39m     [90m// Create a large object (approx 100KB)[39m
     [90m    |[39m                                        [31m[1m^[22m[39m
     [90m 70 |[39m     [36mconst[39m largeObj [33m=[39m {
     [90m 71 |[39m       data[33m:[39m [33mArray[39m([35m10000[39m)[33m.[39mfill([35m0[39m)[33m.[39mmap((_[33m,[39m i) [33m=>[39m ({ id[33m:[39m i[33m,[39m value[33m:[39m [32m`item_${i}`[39m }))
     [90m 72 |[39m     }[0m

      at Object.<anonymous> (tests/jest/tests/stress.test.ts:69:40)

Test Suites: 1 failed, 8 passed, 9 total
Tests:       1 failed, 51 passed, 52 total
Snapshots:   0 total
Time:        7.89 s, estimated 12 s
Ran all test suites.
npm verbose cwd A:\RnD\a51.react-globo-state
npm verbose os Windows_NT 10.0.26200
npm verbose node v24.5.0
npm verbose npm  v11.7.0
npm verbose exit 1
npm verbose code 1
